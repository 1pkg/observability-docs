{/* Comes from sandbox.elastic.dev/test-books/apm/guide/transclusion/tab-widgets/install-agents/ruby.mdx */}

**Install the ((apm-agent))**

Add the agent to your Gemfile.

```ruby
gem 'elastic-apm'
```

**Configure the agent**

<DocTabs>
  <DocTab name="Ruby on Rails">
    APM is automatically started when your app boots.
    Configure the agent by creating the config file `config/elastic_apm.yml`:

    ```ruby
    # config/elastic_apm.yml:
    service_name: '<your-service-name>'
    api_key: '<your-api-key>'
    server_url: '<your-apm-endpoint>'
    environment: '<your-environment>'
    ```

  </DocTab>
  <DocTab name="Rack">
    For Rack or a compatible framework, like Sinatra, include the middleware in your app and start the agent.

    ```ruby
    # config.ru
    require 'sinatra/base'
    class MySinatraApp < Sinatra::Base
      use ElasticAPM::Middleware
      # ...
    end
    ElasticAPM.start(
      app: MySinatraApp, # required
      config_file: '' # optional, defaults to config/elastic_apm.yml
    )
    run MySinatraApp
    at_exit { ElasticAPM.stop }
    ```

    Create a config file `config/elastic_apm.yml`:

    ```ruby
    # config/elastic_apm.yml:
    service_name: '<your-service-name>'
    api_key: '<your-api-key>'
    server_url: '<your-apm-endpoint>'
    environment: '<your-environment>'
    ```

  </DocTab>
</DocTabs>
