{/* Comes from sandbox.elastic.dev/test-books/apm/guide/transclusion/tab-widgets/install-agents/net.mdx */}

**Download the ((apm-agent))**

Add the agent packages from [NuGet](https://www.nuget.org/packages?q=Elastic.apm) to your .NET application.
There are multiple NuGet packages available for different use cases.

For an ASP.NET Core application with Entity Framework Core, download the
[Elastic.Apm.NetCoreAll](https://www.nuget.org/packages/Elastic.Apm.NetCoreAll) package.
This package will automatically add every agent component to your application.

To minimize the number of dependencies, you can use the
[Elastic.Apm.AspNetCore](https://www.nuget.org/packages/Elastic.Apm.AspNetCore) package for just ASP.NET Core monitoring, or the
[Elastic.Apm.EfCore](https://www.nuget.org/packages/Elastic.Apm.EntityFrameworkCore) package for just Entity Framework Core monitoring.

If you only want to use the public agent API for manual instrumentation, use the
[Elastic.Apm](https://www.nuget.org/packages/Elastic.Apm) package.

**Add the agent to the application**

For an ASP.NET Core application with the `Elastic.Apm.NetCoreAll` package,
call the `UseAllElasticApm` method in the `Configure` method within the `Startup.cs` file:

```dotnet
public class Startup
{
  public void Configure(IApplicationBuilder app, IHostingEnvironment env)
  {
    app.UseAllElasticApm(Configuration);
    //…rest of the method
  }
  //…rest of the class
}
```

You can optionally pass an `IConfiguration` instance, and the agent will read
config settings through the `IConfiguration` instance, for example,
from the `appsettings.json` file:

```json
{
  "ElasticApm": {
    "ServiceName": "<your-service-name>",
    "ApiKey": "<your-api-key>",
    "ServerUrl": "<your-apm-endpoint>",
    "Environment": "<your-environment>",
  }
}
```

If you don't pass an `IConfiguration` instance to the agent, for example, in a non-ASP.NET Core application,
you can configure the agent with environment variables.
See the agent reference for more information.
