---
id: serverlessObservabilityCreateInventoryThresholdAlertRule
slug: /serverless/observability/create-inventory-threshold-alert-rule
title: Create an inventory rule
description: Get alerts when the infrastructure inventory exceeds a defined threshold.
tags: [ 'serverless', 'observability', 'how-to', 'alerting' ]
---

import Roles from '../partials/roles.mdx'

<Roles role="Editor" goal="create inventory threshold rules" />

<div id="inventory-threshold-alert"></div>

Based on the resources listed on the **Inventory** page within the ((infrastructure-app)),
you can create a threshold rule to notify you when a metric has reached or exceeded a value for a specific
resource or a group of resources within your infrastructure.

Additionally, each rule can be defined using multiple
conditions that combine metrics and thresholds to create precise notifications and reduce false positives.

1. To access this page, go to **((observability))** -> **Infrastructure**.
1. On the **Inventory** page or the **Metrics Explorer** page, click **Alerts and rules** -> **Infrastructure**.
1. Select **Create inventory rule**.

<DocCallOut title="Tip">

When you select **Create inventory alert**, the parameters you configured on the **Inventory** page will automatically
populate the rule. You can use the Inventory first to view which nodes in your infrastructure you'd
like to be notified about and then quickly create a rule in just a few clicks.

</DocCallOut>

<div id="inventory-conditions"></div>

## Inventory conditions

Conditions for each rule can be applied to specific metrics relating to the inventory type you select.
You can choose the aggregation type, the metric, and by including a warning threshold value, you can be
alerted on multiple threshold values based on severity scores. When creating the rule, you can still get
notified if no data is returned for the specific metric or if the rule fails to query ((es)).

In this example, Kubernetes Pods is the selected inventory type. The conditions state that you will receive
a critical alert for any pods within the `ingress-nginx` namespace with a memory usage of 95% or above
and a warning alert if memory usage is 90% or above.

![Inventory rule](../images/inventory-alert.png)

{/* Does the preview capability exist when creating this rule in serverless? I do not see it in the UI. */}

Before creating a rule, you can preview whether the conditions would have triggered the alert in the last
hour, day, week, or month.

![Preview rules](../images/alert-preview.png)

<div id="action-types-infrastructure"></div>

## Action types

You can extend your rules by connecting them to actions that use the following supported built-in integrations.

![Action types](../images/alert-action-types.png)

After you select a connector, you must set the action frequency. You can choose to create a summary of alerts on each check interval or on a custom interval. For example, send email notifications that summarize the new, ongoing, and recovered alerts each hour:

![Action types](../images/action-alert-summary.png)
{/* NOTE: This is an autogenerated screenshot. Do not edit it directly. */}

Alternatively, you can set the action frequency such that you choose how often the action runs (for example, at each check interval, only when the alert status changes, or at a custom action interval). In this case, you define precisely when the alert is triggered by selecting a specific
threshold condition: `Alert`, `Warning`, or `Recovered` (a value that was once above a threshold has now dropped below it).

![Configure when an alert is triggered](../images/inventory-threshold-run-when-selection.png)
{/* NOTE: This is an autogenerated screenshot. Do not edit it directly. */}

You can also further refine the conditions under which actions run by specifying that actions only run they match a KQL query or when an alert occurs within a specific time frame:

- **If alert matches query**: Enter a KQL query that defines field-value pairs or query conditions that must be met for notifications to send. The query only searches alert documents in the indices specified for the rule.
- **If alert is generated during timeframe**: Set timeframe details. Notifications are only sent if alerts are generated within the timeframe you define.

![Configure a conditional alert](../images/conditional-alerts.png)

## Action variables

Use the default notification message or customize it.
You can add more context to the message by clicking the icon above the message text box
and selecting from a list of available variables.

<DocImage size="xl" url="../images/inventory-threshold-alert-default-message.png" alt="Default notification message for infrastructure threshold rules with open 'Add variable' popup listing available action variables" />
{/* NOTE: This is an autogenerated screenshot. Do not edit it directly. */}

<div id="infra-alert-settings"></div>

## Settings

With infrastructure threshold rules, it's not possible to set an explicit index pattern as part of the configuration. The index pattern
is instead inferred from **Metrics indices** on the <DocLink id="serverlessObservabilityConfigureInfraSettings">Settings</DocLink> page of the ((infrastructure-app)).

With each execution of the rule check, the **Metrics indices** setting is checked, but it is not stored when the rule is created.

