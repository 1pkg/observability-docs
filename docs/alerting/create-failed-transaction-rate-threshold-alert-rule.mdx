---
id: serverlessObservabilityCreateFailedTransactionRateThresholdAlertRule
slug: /serverless/observability/create-failed-transaction-rate-threshold-alert-rule
title: Create failed transaction rate threshold alert rule
description: Create a rule to alert you when the rate of transaction errors in a service exceeds a defined threshold.
tags: [ 'serverless', 'observability', 'how-to', 'alerting' ]
status: rough content
---

import RoughContent from '../partials/rough-content-notice.mdx'

<RoughContent />

You can create a failed transaction rate threshold alert rule to alert you when the rate of transaction errors in a service exceeds a defined threshold. Threshold rules can be set at different levels: environment, service, transaction type, and/or transaction name.   

First you must define the rule and how often it should be evaluated. To turn this into an alert, add an appropriate action (e.g. send email, create issue) to be triggered when the rule conditions are met.  

You can create any rules and alert from scratch using the **Manage Rules** page, or you can start from any page within **Applications** and benefit from some of the details being pre-filled e.g. Name, Tags.

![Create rule for failed transaction rate threshold](../images/apm-alert.png)

<div id="create-failed-transaction-rate-threshold-rule"></div>

To create your failed transaction rate threshold rule:

1. Select **Manage Rules** from the **Alerts** page, and select **Create rule**.
1. Enter a **Name** for your rule, and any optional **Tags** for more granular reporting (leave blank if unsure).
1. Select the **Failed transaction rate threshold** rule type from the APM use case.
1. Select the appropriate **Service**, **Type**, **Environment** and **Name** (or leave **ALL** to include all options). Alternatively, you can select **Use KQL Filter** and enter a KQL expression to limit the scope of your rule.
1. Enter a fail rate in the **Is Above** (defaults to 30%).
1. Define the period to be assessed in **For the last** (defaults to last 5 minutes).
1. Choose how to **Group alerts by** - every unique value will create an alert.
1. Define the interval to check the rule e.g. check every 1 minute.
1. **Save** your rule, or add an action to create an alert for this rule.

<DocCallOut title="Tip">
    You can add an action to a rule at any time. You can create rules without adding actions, and you can also define multiple actions for a single rule. To add actions to rules, you must first create a connector for that service (e.g. email, external incident management system), which you can then use for different rules, each with their own action frequency. For more information on creating connectors, refer to <DocLink id="serverlessObservabilitySendCasesToAnExternalSystem">Send cases to an external system</DocLink>.
</DocCallOut>

{/* Placeholder link for connectors for now  */}

<DocAccordion buttonContent="To create an alert by adding an action to a rule:" initialIsOpen>
1. Either create a rule from scratch or select **Edit rule** from an existing rule.
1. Under **Actions**, select a connector type from the available options.
1. If you have connectors of that type already created, you can select from the available connectors. If you need to add a new connector, select **Create a connector** and refer to <DocLink id="serverlessObservabilitySendCasesToAnExternalSystem">Connectors</DocLink> for more information.
1. For each action you must define the **Action frequency** by choosing between **For each alert** or **Summary of alerts**:
    * **For each alert**: Choose **On status changes** or **On check intervals**, or **On custom action intervals** and define how often to run. For all three options you must also define if **Run when** _Threshold met_ or _Recovered_.
    * **Summary of alerts**: Choose **On check intervals**, or **On custom action intervals** and define how often to run.
1. Select **Save**.    
</DocAccordion>

<div id="create-failed-transaction-rate-threshold-example"></div>
## Example

The failed transaction rate threshold alert triggers when the number of transaction errors in a service exceeds a defined threshold. 

Before continuing, identify the service name, environment name, and transaction type that youâ€™d like to create a failed transaction rate threshold rule for. 

This guide will create an alert for an error group ID based on the following criteria:

* Service: `{your_service.name}`
* Transaction: `{your_transaction.name}`
* Environment: `{your_service.environment}`
* Error rate is above 30% for the last five minutes
* Group alerts by `service.name` and `service.environment`
* Check every 1 minute
* Send the alert via email to the site reliability team

From any page in **Applications**, select **Alerts and rules** -> **Create threshold rule** -> **Failed transaction rate**. Change the name of the alert (if you wish), but do not edit the tags.

Based on the criteria above, define the following rule details:

* **Service**: `{your_service.name}`
* **Type**: `{your_transaction.name}`
* **Environment**: `{your_service.environment}`
* **Is above** - `30%`
* **For the last** - `5 minutes`
* **Group alerts by** - `service.name` `service.environment`
* **Check every** - `1 minute`

Next, select the **Email** connector and click **Create a connector**. Fill out the required details: sender, host, port, etc., and select **Save**.

![Add email action with variables](../images/es-query-rule-action-summary.png)
{/* placeholder image - needs updated and prob re-positioned */}

A default message is provided as a starting point for your alert. You can use the Mustache template syntax (i.e. `{{variable}}`) to pass additional alert values at the time a condition is detected to an action. A list of available variables can be accessed by selecting the add variable button.

Select **Save**. The alert has been created and is now active!




