---
id: serverlessObservabilityAiopsDetectAnomaliesCreateJobs
slug: /serverless/observability/aiops-detect-anomalies-create-jobs
title: Create and run anomaly detection jobs
# description: Description to be written
tags: [ 'serverless', 'observability', 'how-to' ]
status: rough content
---

{/* TODO: Delete me after all relevant content is moved. */}

import RoughContent from '../partials/rough-content-notice.mdx'

<RoughContent />

import AnomalyDetectionJobTips from '../transclusion/machine-learning/anomaly-detection/job-tips.mdx'
import AnomalyDetectionMlDatafeeds from '../transclusion/machine-learning/anomaly-detection/ml-datafeeds.mdx'
import AnomalyDetectionMlCalendars from '../transclusion/machine-learning/anomaly-detection/ml-calendars.mdx'
import AnomalyDetectionMlRules from '../transclusion/machine-learning/anomaly-detection/ml-rules.mdx'
import AnomalyDetectionMlModelSnapshots from '../transclusion/machine-learning/anomaly-detection/ml-model-snapshots.mdx'
import AnomalyDetectionStoppingMl from '../transclusion/machine-learning/anomaly-detection/stopping-ml.mdx'

<div id="ml-ad-run-jobs"></div>

((anomaly-jobs-cap)) contain the configuration information and metadata
necessary to perform the ((ml)) analysis. They can run for a specific time period
or continuously against incoming data.

<div id="ml-ad-setup"></div>

## Set up the environment

Before you can use the ((stack-ml-features)), there are some configuration
requirements (such as security privileges) that must be addressed. Refer to
 <DocBadge><DocIcon size="s" type="unlink" title="missing link"/> missing link</DocBadge>{/* <DocLink id="enMachineLearningSetup">Set up ((ml-features))</DocLink> */}.

<DocCallOut title="Note">

If your data is located outside of ((es)), you cannot use ((kib)) to create
your jobs and you cannot use ((dfeeds)) to retrieve your data in real time.
Posting data directly to ((anomaly-jobs)) is deprecated, in a future major version
a ((dfeed)) will be required.

</DocCallOut>

<div id="ml-ad-create-job"></div>


<div id="ml-ad-job-tips"></div>

<AnomalyDetectionJobTips />

{/*
You can optionally assign jobs to one or more _job groups_. You can use
job groups to view the results from multiple jobs more easily and to expedite
administrative tasks by opening or closing multiple jobs at once.

*/}

{/* TBD Mention impact of model plot config? */}

<div id="ml-ad-datafeeds"></div>

### ((dfeeds-cap))

<AnomalyDetectionMlDatafeeds />

<div id="ml-ad-open-job"></div>

## Open the job

An ((anomaly-job)) must be opened in order for it to be ready to receive and
analyze data. It can be opened and closed multiple times throughout its
lifecycle.

After you start the job, you can start the ((dfeed)), which retrieves data from
your cluster. A ((dfeed)) can be started and stopped multiple times throughout its
lifecycle. When you start it, you can optionally specify start and end times. If
you do not specify an end time, the ((dfeed)) runs continuously.

You can perform both these tasks in ((kib)) or use the
[open ((anomaly-jobs))](((ref))/ml-open-job.html) and
[start ((dfeeds))](((ref))/ml-start-datafeed.html) APIs.

<div id="ml-ad-tune"></div>

## Tune the job

Typically after you open a job, the next step is to
<DocLink id="serverlessObservabilityAiopsDetectAnomaliesViewResults">view the results</DocLink>. You might find that you need to alter
the job configuration or settings.

<div id="ml-ad-calendars"></div>

### Calendars and scheduled events

<AnomalyDetectionMlCalendars />

<div id="ml-ad-rules"></div>

### Custom rules

<AnomalyDetectionMlRules />

<div id="ml-ad-model-snapshots"></div>

### Model snapshots

<AnomalyDetectionMlModelSnapshots />

<div id="ml-ad-close-job"></div>

## Close the job

When historical data is analyzed, there is no need to stop the ((dfeed)) and/or
close the job as they are stopped and closed automatically when the end time is
reached.

<AnomalyDetectionStoppingMl />
