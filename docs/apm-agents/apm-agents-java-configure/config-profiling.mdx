

<div id="config-profiling"></div>

{/* This file is auto generated. Please make your changes in *Configuration.java (for example CoreConfiguration.java) and execute ConfigurationExporter */}

<div id="config-profiling-inferred-spans-enabled"></div>

### `profiling_inferred_spans_enabled` (<DocBadgeAdded tipContent="Added in 1.15.0">1.15.0</DocBadgeAdded> experimental)

<DocCallOut title="Note">
This feature is currently experimental, which means it is disabled by default and it is not guaranteed to be backwards compatible in future releases.
</DocCallOut>

Set to `true` to make the agent create spans for method executions based on
[async-profiler](https://github.com/jvm-profiling-tools/async-profiler), a sampling aka statistical profiler.

Due to the nature of how sampling profilers work,
the duration of the inferred spans are not exact, but only estimations.
The <DocLink id="serverlessObservabilityApmAgentsJavaConfigure" section="profiling_inferred_spans_sampling_interval-added[1150]">`profiling_inferred_spans_sampling_interval`</DocLink> lets you fine tune the trade-off between accuracy and overhead.

The inferred spans are created after a profiling session has ended.
This means there is a delay between the regular and the inferred spans being visible in the UI.

Only platform threads are supported. Virtual threads are not supported and will not be profiled.

<DocCallOut title="Note">
This feature is not available on Windows and on OpenJ9
</DocCallOut>

<DocLink id="serverlessObservabilityApmAgentsJavaConfigure" section="dynamic-configuration"><DocBadge>Dynamic</DocBadge> </DocLink>

| Default | Type | Dynamic |
|---|---|---|
| `false` | Boolean | true |

| Java System Properties | Property file | Environment |
|---|---|---|
| `elastic.apm.profiling_inferred_spans_enabled` | `profiling_inferred_spans_enabled` | `ELASTIC_APM_PROFILING_INFERRED_SPANS_ENABLED` |

{/* This file is auto generated. Please make your changes in *Configuration.java (for example CoreConfiguration.java) and execute ConfigurationExporter */}

<div id="config-profiling-inferred-spans-logging-enabled"></div>

### `profiling_inferred_spans_logging_enabled` (<DocBadgeAdded tipContent="Added in 1.37.0">1.37.0</DocBadgeAdded>)

By default, async profiler prints warning messages about missing JVM symbols to standard output. 
Set this option to `true` to suppress such messages

<DocLink id="serverlessObservabilityApmAgentsJavaConfigure" section="dynamic-configuration"><DocBadge>Dynamic</DocBadge> </DocLink>

| Default | Type | Dynamic |
|---|---|---|
| `true` | Boolean | true |

| Java System Properties | Property file | Environment |
|---|---|---|
| `elastic.apm.profiling_inferred_spans_logging_enabled` | `profiling_inferred_spans_logging_enabled` | `ELASTIC_APM_PROFILING_INFERRED_SPANS_LOGGING_ENABLED` |

{/* This file is auto generated. Please make your changes in *Configuration.java (for example CoreConfiguration.java) and execute ConfigurationExporter */}

<div id="config-profiling-inferred-spans-sampling-interval"></div>

### `profiling_inferred_spans_sampling_interval` (<DocBadgeAdded tipContent="Added in 1.15.0">1.15.0</DocBadgeAdded>)

The frequency at which stack traces are gathered within a profiling session.
The lower you set it, the more accurate the durations will be.
This comes at the expense of higher overhead and more spans for potentially irrelevant operations.
The minimal duration of a profiling-inferred span is the same as the value of this setting.

<DocLink id="serverlessObservabilityApmAgentsJavaConfigure" section="dynamic-configuration"><DocBadge>Dynamic</DocBadge> </DocLink>

Supports the duration suffixes `ms`, `s` and `m`.
Example: `50ms`.

| Default | Type | Dynamic |
|---|---|---|
| `50ms` | TimeDuration | true |

| Java System Properties | Property file | Environment |
|---|---|---|
| `elastic.apm.profiling_inferred_spans_sampling_interval` | `profiling_inferred_spans_sampling_interval` | `ELASTIC_APM_PROFILING_INFERRED_SPANS_SAMPLING_INTERVAL` |

{/* This file is auto generated. Please make your changes in *Configuration.java (for example CoreConfiguration.java) and execute ConfigurationExporter */}

<div id="config-profiling-inferred-spans-min-duration"></div>

### `profiling_inferred_spans_min_duration` (<DocBadgeAdded tipContent="Added in 1.15.0">1.15.0</DocBadgeAdded>)

The minimum duration of an inferred span.
Note that the min duration is also implicitly set by the sampling interval.
However, increasing the sampling interval also decreases the accuracy of the duration of inferred spans.

<DocLink id="serverlessObservabilityApmAgentsJavaConfigure" section="dynamic-configuration"><DocBadge>Dynamic</DocBadge> </DocLink>

Supports the duration suffixes `ms`, `s` and `m`.
Example: `0ms`.

| Default | Type | Dynamic |
|---|---|---|
| `0ms` | TimeDuration | true |

| Java System Properties | Property file | Environment |
|---|---|---|
| `elastic.apm.profiling_inferred_spans_min_duration` | `profiling_inferred_spans_min_duration` | `ELASTIC_APM_PROFILING_INFERRED_SPANS_MIN_DURATION` |

{/* This file is auto generated. Please make your changes in *Configuration.java (for example CoreConfiguration.java) and execute ConfigurationExporter */}

<div id="config-profiling-inferred-spans-included-classes"></div>

### `profiling_inferred_spans_included_classes` (<DocBadgeAdded tipContent="Added in 1.15.0">1.15.0</DocBadgeAdded>)

If set, the agent will only create inferred spans for methods which match this list.
Setting a value may slightly reduce overhead and can reduce clutter by only creating spans for the classes you are interested in.
Example: `org.example.myapp.*`

This option supports the wildcard `*`, which matches zero or more characters.
Examples: `/foo/*/bar/*/baz*`, `*foo*`.
Matching is case insensitive by default.
Prepending an element with `(?-i)` makes the matching case sensitive.

<DocLink id="serverlessObservabilityApmAgentsJavaConfigure" section="dynamic-configuration"><DocBadge>Dynamic</DocBadge> </DocLink>

| Default | Type | Dynamic |
|---|---|---|
| `*` | List | true |

| Java System Properties | Property file | Environment |
|---|---|---|
| `elastic.apm.profiling_inferred_spans_included_classes` | `profiling_inferred_spans_included_classes` | `ELASTIC_APM_PROFILING_INFERRED_SPANS_INCLUDED_CLASSES` |

{/* This file is auto generated. Please make your changes in *Configuration.java (for example CoreConfiguration.java) and execute ConfigurationExporter */}

<div id="config-profiling-inferred-spans-excluded-classes"></div>

### `profiling_inferred_spans_excluded_classes` (<DocBadgeAdded tipContent="Added in 1.15.0">1.15.0</DocBadgeAdded>)

Excludes classes for which no profiler-inferred spans should be created.

This option supports the wildcard `*`, which matches zero or more characters.
Examples: `/foo/*/bar/*/baz*`, `*foo*`.
Matching is case insensitive by default.
Prepending an element with `(?-i)` makes the matching case sensitive.

<DocLink id="serverlessObservabilityApmAgentsJavaConfigure" section="dynamic-configuration"><DocBadge>Dynamic</DocBadge> </DocLink>

| Default | Type | Dynamic |
|---|---|---|
| `(?-i)java.*, (?-i)javax.*, (?-i)sun.*, (?-i)com.sun.*, (?-i)jdk.*, (?-i)org.apache.tomcat.*, (?-i)org.apache.catalina.*, (?-i)org.apache.coyote.*, (?-i)org.jboss.as.*, (?-i)org.glassfish.*, (?-i)org.eclipse.jetty.*, (?-i)com.ibm.websphere.*, (?-i)io.undertow.*` | List | true |

| Java System Properties | Property file | Environment |
|---|---|---|
| `elastic.apm.profiling_inferred_spans_excluded_classes` | `profiling_inferred_spans_excluded_classes` | `ELASTIC_APM_PROFILING_INFERRED_SPANS_EXCLUDED_CLASSES` |

{/* This file is auto generated. Please make your changes in *Configuration.java (for example CoreConfiguration.java) and execute ConfigurationExporter */}

<div id="config-profiling-inferred-spans-lib-directory"></div>

### `profiling_inferred_spans_lib_directory` (<DocBadgeAdded tipContent="Added in 1.18.0">1.18.0</DocBadgeAdded>)

Profiling requires that the [async-profiler](https://github.com/jvm-profiling-tools/async-profiler) shared library is exported to a temporary location and loaded by the JVM.
The partition backing this location must be executable, however in some server-hardened environments, `noexec` may be set on the standard `/tmp` partition, leading to `java.lang.UnsatisfiedLinkError` errors.
Set this property to an alternative directory (e.g. `/var/tmp`) to resolve this.
If unset, the value of the `java.io.tmpdir` system property will be used.

| Default | Type | Dynamic |
|---|---|---|
| `<none>` | String | false |

| Java System Properties | Property file | Environment |
|---|---|---|
| `elastic.apm.profiling_inferred_spans_lib_directory` | `profiling_inferred_spans_lib_directory` | `ELASTIC_APM_PROFILING_INFERRED_SPANS_LIB_DIRECTORY` |

