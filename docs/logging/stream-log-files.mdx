---
id: serverlessObservabilityStreamLogFiles
slug: /serverless/observability/stream-log-files
title: Stream any log file
description: Send a log file to Elasticsearch using the standalone ((agent)).
tags: [ 'serverless', 'observability', 'how-to' ]
status: in testing
---

import Feedback from '../partials/feedback/widget.mdx'

import Testing from '../partials/in-testing-notice.mdx'

<Testing />

import DownloadWidget from '../transclusion/fleet/tab-widgets/download-widget.mdx'
import RunStandaloneWidget from '../transclusion/fleet/tab-widgets/run-standalone-widget.mdx'
import AgentLocationWidget from '../transclusion/observability/tab-widgets/logs/agent-location/widget.mdx'
import StopWidget from '../transclusion/fleet/tab-widgets/stop-widget.mdx'
import StartWidget from '../transclusion/fleet/tab-widgets/start-widget.mdx'

In this guide, you'll learn how to send a log file to Elasticsearch using a standalone ((agent)), configure the ((agent)) and your data streams using the `elastic-agent.yml` file, and query your logs using the data streams you've set up.

The quickest way to get started is to:

1. Open your Observability project. If you don't have one, <DocLink id="serverlessObservabilityCreateAnObservabilityProject" text="create an observability project"/>.
1. Go to **Add data**.
1. Under _Stream log files_, click **Get stated**.

This will kick off a set of guided instructions in your project. These instructions will walk you through how to
configure the standalone ((agent)) and send log data to your project.

## Configure inputs and integration

Enter a few configuration details in the guided instructions.

{/* Do we want to include a screenshot or will it be too difficult to maintain? */}
![Configure inputs and integration in the Stream log files guided instructions](../images/logs-stream-logs-config.png)

**Configure inputs**

* **Log file path**: The path to your log files.
  You can also use a pattern like `/var/log/your-logs.log*`.
  Click **Add row** to add more log file paths.
  
  This will be passed to the `paths` field in the generated `elastic-agent.yml` file in a future step.
  <br />
  
* **Service name**: Provide a service name to allow for distributed services running on
  multiple hosts to correlate the related instances.
  
  The service name will be used in the Log Explorer.
  It will appear in the "All logs" dropdown menu.

  <DocImage url="../images/logs-stream-logs-service-name.png" alt="All logs dropdown menu on the Log Explorer page" size="l" />

{/* Advanced settings? */}

**Configure integration**

Elastic creates an integration to streamline connecting your log data to Elastic.

* **Integration name**: Give your integration a name.
  This is a unique identifier for your stream of log data that you can later use to filter data in the Log Explorer.
  The value must be unique within your project, all lowercase, and max 100 chars. Special characters will be replaced with `_`.
  
  This will be passed to the `streams.id` field in the generated `elastic-agent.yml` file in a future step.
  <br />

* **Dataset name**: Give your integration's dataset a name.
  The name for your dataset data stream. Name this data stream anything that signifies the source of the data.
  The value must be all lowercase and max 100 chars. Special characters will be replaced with `_`.
  
  This will be passed to the `data_stream.dataset` field in the generated `elastic-agent.yml` file in a future step.

## Install and configure the standalone ((agent))

After configuring the inputs and integration, you'll continue in the guided instructions to
install and configure the standalone ((agent)).

### Step 1: Download and extract the ((agent)) installation package

On your host, download and extract the installation package that corresponds with your system:

<DownloadWidget />

### Step 2: Install and start the ((agent))

After downloading and extracting the installation package, you're ready to install the ((agent)).
From the agent directory, run the install command that corresponds with your system:

<DocCallOut title="Note">
On macOS, Linux (tar package), and Windows, run the `install` command to
install and start ((agent)) as a managed service and start the service. The DEB and RPM
packages include a service unit for Linux systems with
systemd, For these systems, you must enable and start the service.
</DocCallOut>

<RunStandaloneWidget />

<br />

During installation, you'll be prompted with some questions:

1. When asked if you want to install the agent as a service, enter `Y`. 
1. When asked if you want to enroll the agent in Fleet, enter `n`.

### Step 3: Configure the ((agent))

After your agent is installed, configure it by updating the `elastic-agent.yml` file. 

#### Locate your configuration file

After installing the agent, you'll find the `elastic-agent.yml` in one of the following locations according to your system:

<AgentLocationWidget />

#### Update your configuration file

If you're following the guided instructions, they will include an updated configuration file
that you can download and use.
The values you provided in <DocLink id="serverlessObservabilityStreamLogFiles" section="configure-inputs-and-integration">Configure inputs and integration</DocLink> will be prepopulated in the generated configuration file.

The generated configuration file will contain the following fields:

<DocTable columns={[
  { title: "Field", width: "25%" },
  { title: "Value", width: "75%" }
]}>
  <DocRow>
    <DocCell>`hosts`</DocCell>
    <DocCell>
      Copy the ((es)) endpoint from your project's page and add the port (the default port is `443`). For example, `https://my-deployment.es.us-central1.gcp.cloud.es.io:443`.

      If you're following the guided instructions in your project, 
      the ((es)) endpoint will be prepopulated in the configuration file.

      <DocCallOut title="Tip">
      If you need to find your project's ((es)) endpoint outside the guided instructions:
      
      1. Go to the **Projects** page that lists all your projects.
      1. Click **Manage** next to the project you want to connect to.
      1. Click **View** next to _Endpoints_.
      1. Copy the _Elasticsearch endpoint_.

      <br />

      ![Copy a project's Elasticsearch endpoint](../images/log-copy-es-endpoint.png)
      </DocCallOut>
    </DocCell>
  </DocRow>
  <DocRow>
    <DocCell>`api-key`</DocCell>
    <DocCell>
      Use an API key to grant the agent access to your project.
      The API key format should be `<id>:<key>`.

      If you're following the guided instructions in your project, an API key will be autogenerated
      and will be prepopulated in the downloadable configuration file.

      <div id="api-key-beats"></div>

      <DocCallOut title="Important" color="warning">
      Alternatively, you can create an API key by navigating to **Project settings -> Management -> API keys**
      and clicking **Create API key**. If you create an API key this way, you _must_ make sure it's formatted to configure ((beats)).
      
      Immediately after the API key is generated and while it is still being displayed, you must click the
      **Encoded** button next to the API key and select **Beats** from the list in the tooltip.
      Base64 encoded API keys are not currently supported in this configuration.

      ![](../images/logs-stream-logs-api-key-beats.png)
      </DocCallOut>
    </DocCell>
  </DocRow>
  <DocRow>
    <DocCell>`inputs.id`</DocCell>
    <DocCell>
      A unique identifier for your input.
    </DocCell>
  </DocRow>
  <DocRow>
    <DocCell>`type`</DocCell>
    <DocCell>
      The type of input. For collecting logs, set this to `filestream`.
    </DocCell>
  </DocRow>
  <DocRow>
    <DocCell>`streams.id`</DocCell>
    <DocCell>
      A unique identifier for your stream of log data.

      If you're following the guided instructions in your project, this will be prepopulated with
      the value you specified in <DocLink id="serverlessObservabilityStreamLogFiles" section="configure-inputs-and-integration">Configure inputs and integration</DocLink>.
    </DocCell>
  </DocRow>
  <DocRow>
    <DocCell>`data_stream.dataset`</DocCell>
    <DocCell>
      The name for your dataset data stream. Name this data stream anything that signifies the source of the data.
      The default value is `generic`.

      If you're following the guided instructions in your project, this will be prepopulated with
      the value you specified in <DocLink id="serverlessObservabilityStreamLogFiles" section="configure-inputs-and-integration">Configure inputs and integration</DocLink>.
    </DocCell>
  </DocRow>
  <DocRow>
    <DocCell>`paths`</DocCell>
    <DocCell>
      The path to your log files. You can also use a pattern like `/var/log/your-logs.log*`.

      If you're following the guided instructions in your project, this will be prepopulated with
      the value you specified in <DocLink id="serverlessObservabilityStreamLogFiles" section="configure-inputs-and-integration">Configure inputs and integration</DocLink>.
    </DocCell>
  </DocRow>
</DocTable>

If you're not using the guided instructions, you can update the default configuration in `elastic-agent.yml` manually.
It should look something like this:

```yaml
outputs:
  default:
    type: elasticsearch
    hosts: '<your-elasticsearch-endpoint>:<port>'
    api_key: 'your-api-key'
inputs:
  - id: your-log-id
    type: filestream
    streams:
      - id: your-log-stream-id
        data_stream.dataset: generic
        paths:
          - /var/log/your-logs.log
```

#### Restart the ((agent))

After updating your configuration file, you need to restart the ((agent)).

First, stop the ((agent)) and its related executables using the command that works with your system:

<StopWidget />

<br />

Next, restart the ((agent)) using the command that works with your system:

<StartWidget />

## View and search your data

With your ((agent)) and data streams configured, you can now view, filter, and search your log data.
In your Observability project, go to the **Log Explorer**.
Use the search bar to find your `data_stream.type` and `data_stream.dataset`. 

## Troubleshoot your ((agent)) configuration

If you're not seeing your log files in your project, verify the following in the `elastic-agent.yml` file:

- The path to your logs file under `paths` is correct.
- Your API key is in `<id>:<key>` format. If not, your API key may be in an unsupported format, and you'll need to create an API key in **Beats** format. Refer to <DocLink id="serverlessObservabilityStreamLogFiles" section="api-key-beats">`api-key` in the table</DocLink> above.

If you're still running into issues, refer to [((agent)) troubleshooting](((fleet-guide))/fleet-troubleshooting.html) and [Configure standalone Elastic Agents](((fleet-guide))/elastic-agent-configuration.html).

<Feedback slug="/serverless/observability/stream-log-files" filepath="docs/logging/stream-log-files.mdx" />
